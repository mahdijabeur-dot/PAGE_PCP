<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Ajouter PCP</title></head>

<body>

<script>
const PAGE = `
<h2>Ajouter un PCP</h2>

<form id="createForm" class="mt-3">

    <label>Processus</label>
    <input class="form-control mb-3" name="processus">

    <label>Description</label>
    <textarea class="form-control mb-3" name="description"></textarea>

    <label>Fréquence</label>
    <input class="form-control mb-3" name="frequence">

    <button class="btn btn-success">Enregistrer</button>
</form>
`;

const SCRIPT = `
document.getElementById("createForm").onsubmit = async(e)=>{
    e.preventDefault();
    const data = new FormData(e.target);

    await fetch("api/pcp.php?action=create",{
        method:"POST",
        body:data
    });

    alert("PCP ajouté !");
    window.location="table-view.html";
};
`;
</script>

<script>
window.onload=async()=>{
    let layout=await fetch("layout.html").then(r=>r.text());
    document.open();
    document.write(layout
        .replace("{{title}}","Ajouter PCP")
        .replace("{{content}}", PAGE)
        .replace("{{scripts}}", `<script>${SCRIPT}</script>`)
    );
    document.close();
};
</script>

</body>
</html>
